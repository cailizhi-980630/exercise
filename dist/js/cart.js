"use strict";var un=getCookie("user");function aj(){$.ajax({url:"../php/commodity2.php",data:{username:un},dataType:"json",type:"post",success:function(t){console.log(t);var n=Number(t.amount1)+Number(t.amount2)+Number(t.amount3)+Number(t.amount4)+Number(t.amount5);$(".order>i").text(n),$(".tab-cart-num").text(n),$.ajax({url:"../php/cart.php",data:{amount1:t.amount1,amount2:t.amount2,amount3:t.amount3,amount4:t.amount4,amount5:t.amount5},dataType:"json",type:"post",success:function(t){$(".numb").text(n),money=0,t.forEach(function(t,n){money+=t[0].num*t.price}),$(".sn-price>em").text(money)}})}})}console.log(un),$.ajax({url:"../php/register.php",data:{username:un},dataType:"json",type:"post",success:function(t){1==t.code&&($(".reg-bar-node").css("display","none"),$(".wdyg-name").text("欢迎回来"+un))}}),$.ajax({url:"../php/commodity2.php",data:{username:un},dataType:"json",type:"post",success:function(t){console.log(t);var n=Number(t.amount1)+Number(t.amount2)+Number(t.amount3)+Number(t.amount4)+Number(t.amount5);$(".order>i").text(n),$(".tab-cart-num").text(n),$.ajax({url:"../php/cart.php",data:{amount1:t.amount1,amount2:t.amount2,amount3:t.amount3,amount4:t.amount4,amount5:t.amount5},dataType:"json",type:"post",success:function(t){$(".numb").text(n),money=0,t.forEach(function(t,n){$(".tbody").append("\n                    <tr>\n                        <th>".concat(t.id,'</th>\n                        <th>\n                            <div>\n                            <img src="').concat(t.img,'">\n                            <span>').concat(t.trade,"</span>\n                        </div>\n                        </th>\n                        <th>\n                            <p>").concat(t.trade,"</p>\n                        </th>\n                        <th>").concat(t.price,'</th>\n                        <th>\n                        <a class="subtractA"></a>\n                        <input class="number" type="text" max="99" min="1" value="').concat(parseInt(t[0].num),'">\n                        <a class="plusA"></a>\n                        </th>\n                        <th>').concat(t[0].num*t.price,'</th>\n                        <th><a class="del">删除</a></th>\n                    </tr>\n                    ')),money+=t[0].num*t.price}),$(".sn-price>em").text(money)}})}}),$(".tbody").on("click",".subtractA",function(){$(this).next().val($(this).next().val()-1),$.ajax({url:"../php/cart1.php",data:{username:un,num:$(this).next().val(),trade:$(this).parent().parent().children(3).children().eq(1).text()},dataType:"json",type:"post"}),0==$(this).next().val()&&$(this).parent().parent().hide(),aj()}),$(".tbody").on("click",".del",function(){$(this).parent().parent().hide(),$.ajax({url:"../php/cart1.php",data:{username:un,num:0,trade:$(this).parent().parent().children(3).children().eq(1).text()},dataType:"json",type:"post"}),aj()}),$(".tbody").on("click",".plusA",function(){$num=parseInt($(this).prev().val()),$(this).prev().val($num+1),99<$(this).prev().val()&&$(this).prev().val(99),$.ajax({url:"../php/cart1.php",data:{username:un,num:$(this).prev().val(),trade:$(this).parent().parent().children(3).children().eq(1).text()},dataType:"json",type:"post"}),aj()}),$(".tbody").html()||aj();